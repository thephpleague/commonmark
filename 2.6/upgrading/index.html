




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <meta name="description" content="Guide to upgrading to newer versions of this library">
    
    <meta name="docsearch:version" content="2.6">
    
        <title>Upgrading from 2.5 to 2.6 - CommonMark for PHP</title>
    
    <link rel="icon" type="image/x-icon" href="//theme.thephpleague.com/img/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" href="//theme.thephpleague.com/img/apple-touch-icon-precomposed.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@thephpleague" />
    <meta name="twitter:creator" content="@colinodell" />
    <meta property="og:url" content="https://commonmark.thephpleague.com/2.6/upgrading/" />
    
        <meta property="og:title" content="Upgrading from 2.5 to 2.6 - CommonMark for PHP" />
    
    
        <meta property="og:description" content="Guide to upgrading to newer versions of this library" />
    
    <meta property="og:image" content="https://commonmark.thephpleague.com/images/commonmark-social.png" />
    <link rel="stylesheet" href="//theme.thephpleague.com/css/all.css?">
    <link rel="stylesheet" href="/custom.css?">
    <link rel="stylesheet" href="/global.css?">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <link rel="stylesheet" href="/support.css?">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-137970568-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-137970568-1');
    </script>
</head>
<body>
<header>
    <div class="header-content">
        <h1 class="title">
            <a class="logo" href="/">
            <span class="name">
                <em>League\</em>CommonMark
            </span>
            </a>
        </h1>
        <div class="search"><input type="search" id="doc-search" placeholder="search the docs..."></div>
        <nav class="versions">
            <h2>v2.6 &#9662;</h2>
            <ul>
            
                <li ><a href="/2.7/upgrading/">v2.7</a></li>
            
                <li class="selected"><a href="/2.6/upgrading/">v2.6</a></li>
            
                <li ><a href="/2.5/upgrading/">v2.5</a></li>
            
                <li ><a href="/2.4/upgrading/">v2.4</a></li>
            
                <li ><a href="/2.3/upgrading/">v2.3</a></li>
            
                <li ><a href="/2.2/upgrading/">v2.2</a></li>
            
                <li ><a href="/2.1/upgrading/">v2.1</a></li>
            
                <li ><a href="/2.0/upgrading/">v2.0</a></li>
            
                <li ><a href="/1.6/upgrading/">v1.6</a></li>
            
                <li ><a href="/releases/">Notes</a></li>
            </ul>
        </nav>
    </div>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776;</div>
    <div class="open">&#10799;</div>
</label>

<main>
    <menu>
        <div class="versions-small">
        <h2>Versions</h2>
            <ul>
        
                <li >
                    <a href="/2.7/">2.7</a>
                </li>
        
                <li class="selected">
                    <a href="/2.6/">2.6</a>
                </li>
        
                <li >
                    <a href="/2.5/">2.5</a>
                </li>
        
                <li >
                    <a href="/2.4/">2.4</a>
                </li>
        
                <li >
                    <a href="/2.3/">2.3</a>
                </li>
        
                <li >
                    <a href="/2.2/">2.2</a>
                </li>
        
                <li >
                    <a href="/2.1/">2.1</a>
                </li>
        
                <li >
                    <a href="/2.0/">2.0</a>
                </li>
        
                <li >
                    <a href="/1.6/">1.6</a>
                </li>
        
                <li ><a href="/releases/">Releases Notes</a></li>
            </ul>
        </div>

        
            
            <div class="menu-section">
                <h2>Getting Started</h2>
                <ul>
                    
                        <li >
                            <a href="/2.6/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/installation/">Installation</a>
                        </li>
                    
                        <li class="selected">
                            <a href="/2.6/upgrading/">Upgrading from 2.5</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/changelog/">Changelog</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/support/">Support</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Usage</h2>
                <ul>
                    
                        <li >
                            <a href="/2.6/basic-usage/">Basic Usage</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/xml/">XML</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Extensions</h2>
                <ul>
                    
                        <li >
                            <a href="/2.6/extensions/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/commonmark/">CommonMark</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/github-flavored-markdown/">GitHub-Flavored Markdown</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/attributes/">Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/autolinks/">Autolinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/default-attributes/">Default Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/description-lists/">Description Lists</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/disallowed-raw-html/">Disallowed Raw HTML</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/embed/">Embed</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/external-links/">External Links</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/footnotes/">Footnotes</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/front-matter/">Front Matter</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/heading-permalinks/">Heading Permalinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/inlines-only/">Inlines Only</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/mentions/">Mentions</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/smart-punctuation/">Smart Punctuation</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/strikethrough/">Strikethrough</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/table-of-contents/">Table of Contents</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/tables/">Tables</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/extensions/task-lists/">Task Lists</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Customization</h2>
                <ul>
                    
                        <li >
                            <a href="/2.6/customization/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/environment/">Environment</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/extensions/">Extensions</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/event-dispatcher/">Event Dispatcher</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/cursor/">Cursor</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/block-parsing/">Block Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/inline-parsing/">Inline Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/delimiter-processing/">Delimiter Processing</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/abstract-syntax-tree/">Abstract Syntax Tree</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/rendering/">Rendering</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/slug-normalizer/">Slug Normalizer</a>
                        </li>
                    
                        <li >
                            <a href="/2.6/customization/disabling-features/">Disabling Features</a>
                        </li>
                    
                </ul>
            </div>
            
        
    </menu>
    <article>
    

    
        <p class="message-notice">This is the documentation for <code>version 2.6</code>. Please consider upgrading your code to <a href="/2.7/">the latest stable version</a></p>
    

    

        <h1 id="upgrading-from-25-to-26">Upgrading from 2.5 to 2.6</h1>

<h2 id="max_delimiters_per_line-configuration-option"><code class="language-plaintext highlighter-rouge">max_delimiters_per_line</code> Configuration Option</h2>

<p>The <code class="language-plaintext highlighter-rouge">max_delimiters_per_line</code> configuration option was added in 2.6 to help protect against malicious input that could
cause excessive memory usage or denial of service attacks.  It defaults to <code class="language-plaintext highlighter-rouge">PHP_INT_MAX</code> (no limit) for backwards
compatibility, which is safe when parsing trusted input. However, if you’re parsing untrusted input from users, you
should probably set this to a reasonable value (somewhere between <code class="language-plaintext highlighter-rouge">100</code> and <code class="language-plaintext highlighter-rouge">1000</code>) to protect against malicious inputs.</p>

<h2 id="custom-delimiter-processors">Custom Delimiter Processors</h2>

<p>If you’re implementing a custom delimiter processor, and <code class="language-plaintext highlighter-rouge">getDelimiterUse()</code> has more logic than just a
simple <code class="language-plaintext highlighter-rouge">return</code> statement, you should implement <code class="language-plaintext highlighter-rouge">CacheableDelimiterProcessorInterface</code> instead of
<code class="language-plaintext highlighter-rouge">DelimiterProcessorInterface</code> to improve performance and avoid possible quadratic performance issues.</p>

<p><code class="language-plaintext highlighter-rouge">DelimiterProcessorInterface</code> has a <code class="language-plaintext highlighter-rouge">getDelimiterUse()</code> method that tells the engine how many characters from the
matching delimiters should be consumed. Simple processors usually always return a hard-coded integer like <code class="language-plaintext highlighter-rouge">1</code> or <code class="language-plaintext highlighter-rouge">2</code>.
However, some more advanced processors may need to examine the opening and closing delimiters and perform additional
logic to determine whether they should be fully or partially consumed.  Previously, these results could not be safely
cached, resulting in possible quadratic performance issues.</p>

<p>In 2.6, the <code class="language-plaintext highlighter-rouge">CacheableDelimiterProcessorInterface</code> was introduced to allow these “dynamic” processors to be safely
cached. It requires a new <code class="language-plaintext highlighter-rouge">getCacheKey()</code> method that returns a string that uniquely identifies the combination of
factors considered when determining the delimiter use.  This key is then used to cache the results of the search for
a matching delimiter.</p>


        <hr>

        <p>
            <a class="btn btn-sm btn-black" href="https://github.com/thephpleague/commonmark/edit/2.7/docs/2.6/upgrading.md" title="Edit this page on GitHub" target="_blank" rel="noopener"><i class="fas fa-edit"></i> Edit this page</a>
        </p>
    </article>

    <aside class="support-banner-wrapper" x-data="{ show: false }" x-show.transition="show" x-init="h = localStorage.getItem('hideBanner'); (h === null || h < (new Date().getTime())) ? (setTimeout(() => show = true, 500)) : (show = false)">
        <div class="support-banner">
            <p class="support-banner-left">
                <strong>Love PHP Commonmark?</strong>
                <span class="hidden sm:inline-block lg:hidden">
                    Show your support!
                </span>

                <span class="hidden lg:inline-block">
                    Support development via monthly sponsorship or a one-time donation!
                </span>
            </p>

            <div class="support-banner-right">
                <a href="https://github.com/sponsors/colinodell" class="btn btn-pink btn-block">
                    <i class="fas fa-heart fa-fw" aria-hidden="true"></i> Sponsor
                </a>

                <a href="https://www.paypal.me/colinpodell/10.00" class="btn btn-green btn-block">
                    <i class="fas fa-donate fa-fw" aria-hidden="true"></i> Donate
                </a>
            </div>

            <button x-on:click="localStorage.setItem('hideBanner', new Date().getTime() + (7*24*60*60*1000)); show = false" class="support-banner-close">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
    </aside>
</main>

<footer>
    <span>&copy; Copyright <a href="https://www.colinodell.com">Colin O'Dell</a> &amp; <a href="//thephpleague.com">The League of Extraordinary Packages</a>.</span>
    <span>Site design by <a href="//reinink.ca">Jonathan Reinink</a> and <a href="//nyamsprod.com">Ignace Nyamagana Butera</a>.</span>
</footer>
<script src="/custom.js?"></script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
<script> docsearch({
    apiKey: 'f8a60b0120292f75f23d313f6cebba05',
    appId: '5WPQI5503X',
    indexName: 'commonmark-thephpleague',
    inputSelector: '#doc-search',
    algoliaOptions: { 'facetFilters': ["version:v2.6"] },
    debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
