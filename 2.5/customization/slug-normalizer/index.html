




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <meta name="description" content="Using the Slug Normalizer to produce unique, URL-safe text strings">
    
    <meta name="docsearch:version" content="2.5">
    
        <title>Slug Normalizer - CommonMark for PHP</title>
    
    <link rel="icon" type="image/x-icon" href="//theme.thephpleague.com/img/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" href="//theme.thephpleague.com/img/apple-touch-icon-precomposed.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@thephpleague" />
    <meta name="twitter:creator" content="@colinodell" />
    <meta property="og:url" content="https://commonmark.thephpleague.com/2.5/customization/slug-normalizer/" />
    
        <meta property="og:title" content="Slug Normalizer - CommonMark for PHP" />
    
    
        <meta property="og:description" content="Using the Slug Normalizer to produce unique, URL-safe text strings" />
    
    <meta property="og:image" content="https://commonmark.thephpleague.com/images/commonmark-social.png" />
    <link rel="stylesheet" href="//theme.thephpleague.com/css/all.css?">
    <link rel="stylesheet" href="/custom.css?">
    <link rel="stylesheet" href="/global.css?">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <link rel="stylesheet" href="/support.css?">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-137970568-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-137970568-1');
    </script>
</head>
<body>
<header>
    <div class="header-content">
        <h1 class="title">
            <a class="logo" href="/">
            <span class="name">
                <em>League\</em>CommonMark
            </span>
            </a>
        </h1>
        <div class="search"><input type="search" id="doc-search" placeholder="search the docs..."></div>
        <nav class="versions">
            <h2>v2.5 &#9662;</h2>
            <ul>
            
                <li ><a href="/2.7/customization/slug-normalizer/">v2.7</a></li>
            
                <li ><a href="/2.6/customization/slug-normalizer/">v2.6</a></li>
            
                <li class="selected"><a href="/2.5/customization/slug-normalizer/">v2.5</a></li>
            
                <li ><a href="/2.4/customization/slug-normalizer/">v2.4</a></li>
            
                <li ><a href="/2.3/customization/slug-normalizer/">v2.3</a></li>
            
                <li ><a href="/2.2/customization/slug-normalizer/">v2.2</a></li>
            
                <li ><a href="/2.1/customization/slug-normalizer/">v2.1</a></li>
            
                <li ><a href="/2.0/customization/slug-normalizer/">v2.0</a></li>
            
                <li ><a href="/1.6/">v1.6</a></li>
            
                <li ><a href="/releases/">Notes</a></li>
            </ul>
        </nav>
    </div>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776;</div>
    <div class="open">&#10799;</div>
</label>

<main>
    <menu>
        <div class="versions-small">
        <h2>Versions</h2>
            <ul>
        
                <li >
                    <a href="/2.7/">2.7</a>
                </li>
        
                <li >
                    <a href="/2.6/">2.6</a>
                </li>
        
                <li class="selected">
                    <a href="/2.5/">2.5</a>
                </li>
        
                <li >
                    <a href="/2.4/">2.4</a>
                </li>
        
                <li >
                    <a href="/2.3/">2.3</a>
                </li>
        
                <li >
                    <a href="/2.2/">2.2</a>
                </li>
        
                <li >
                    <a href="/2.1/">2.1</a>
                </li>
        
                <li >
                    <a href="/2.0/">2.0</a>
                </li>
        
                <li >
                    <a href="/1.6/">1.6</a>
                </li>
        
                <li ><a href="/releases/">Releases Notes</a></li>
            </ul>
        </div>

        
            
            <div class="menu-section">
                <h2>Getting Started</h2>
                <ul>
                    
                        <li >
                            <a href="/2.5/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/upgrading/">Upgrading from 2.4</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/changelog/">Changelog</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/support/">Support</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Usage</h2>
                <ul>
                    
                        <li >
                            <a href="/2.5/basic-usage/">Basic Usage</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/xml/">XML</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Extensions</h2>
                <ul>
                    
                        <li >
                            <a href="/2.5/extensions/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/commonmark/">CommonMark</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/github-flavored-markdown/">GitHub-Flavored Markdown</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/attributes/">Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/autolinks/">Autolinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/default-attributes/">Default Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/description-lists/">Description Lists</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/disallowed-raw-html/">Disallowed Raw HTML</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/embed/">Embed</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/external-links/">External Links</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/footnotes/">Footnotes</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/front-matter/">Front Matter</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/heading-permalinks/">Heading Permalinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/inlines-only/">Inlines Only</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/mentions/">Mentions</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/smart-punctuation/">Smart Punctuation</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/strikethrough/">Strikethrough</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/table-of-contents/">Table of Contents</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/tables/">Tables</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/extensions/task-lists/">Task Lists</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Customization</h2>
                <ul>
                    
                        <li >
                            <a href="/2.5/customization/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/environment/">Environment</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/extensions/">Extensions</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/event-dispatcher/">Event Dispatcher</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/cursor/">Cursor</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/block-parsing/">Block Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/inline-parsing/">Inline Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/delimiter-processing/">Delimiter Processing</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/abstract-syntax-tree/">Abstract Syntax Tree</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/rendering/">Rendering</a>
                        </li>
                    
                        <li class="selected">
                            <a href="/2.5/customization/slug-normalizer/">Slug Normalizer</a>
                        </li>
                    
                        <li >
                            <a href="/2.5/customization/disabling-features/">Disabling Features</a>
                        </li>
                    
                </ul>
            </div>
            
        
    </menu>
    <article>
    

    

    
        <p class="message-warning">This is the documentation for the unsupported <code>version 2.5</code>. Please consider upgrading your code to <a href="/2.7/">the latest stable version</a></p>
    

        <h1 id="slug-normalizer">Slug Normalizer</h1>

<p>“Slugs” are strings used within <code class="language-plaintext highlighter-rouge">href</code>, <code class="language-plaintext highlighter-rouge">name</code>, and <code class="language-plaintext highlighter-rouge">id</code> HTML attributes to identify particular elements within a document.</p>

<p>Some extensions (like the <code class="language-plaintext highlighter-rouge">HeadingPermalinkExtension</code>) need the ability to convert user-provided text into these URL-safe slugs while also ensuring that these are unique throughout the generated HTML.  The <code class="language-plaintext highlighter-rouge">Environment</code> provides a pre-built normalizer you can use for this purpose.</p>

<h2 id="usage">Usage</h2>

<p>You can obtain a reference to the built-in slug normalizer by calling <code class="language-plaintext highlighter-rouge">$environment-&gt;getSlugNormalizer()</code>;</p>

<p>To use this within your extension, have your parser/renderer/whatever implement <code class="language-plaintext highlighter-rouge">EnvironmentAwareInterface</code> and then implement the corresponding <code class="language-plaintext highlighter-rouge">setEnvironment</code> method like this:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">use</span> <span class="nc">League\CommonMark\Environment\EnvironmentInterface</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Environment\EnvironmentAwareInterface</span><span class="p">;</span>

<span class="kd">class</span> <span class="nc">MyCustomParserOrRenderer</span> <span class="kd">implements</span> <span class="nc">EnvironmentAwareInterface</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nv">$slugNormalizer</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">setEnvironment</span><span class="p">(</span><span class="kt">EnvironmentInterface</span> <span class="nv">$environment</span><span class="p">):</span> <span class="kt">void</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">slugNormalizer</span> <span class="o">=</span> <span class="nv">$environment</span><span class="o">-&gt;</span><span class="nf">getSlugNormalizer</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You can then call <code class="language-plaintext highlighter-rouge">$this-&gt;slugNormalizer-&gt;normalize($text)</code> as needed.</p>

<h2 id="configuration">Configuration</h2>

<p>The <code class="language-plaintext highlighter-rouge">slug_normalizer</code> configuration section allows you to adjust the following options:</p>

<h3 id="instance"><code class="language-plaintext highlighter-rouge">instance</code></h3>

<p>You can change the string that is used as the “slug” by setting the <code class="language-plaintext highlighter-rouge">instance</code> option to any class that implements <code class="language-plaintext highlighter-rouge">TextNormalizerInterface</code>.
We provide a simple <code class="language-plaintext highlighter-rouge">SlugNormalizer</code> by default, but you may want to plug in a different library or create your own normalizer instead.</p>

<p>For example, if you’d like each slug to be an MD5 hash, you could create a class like this:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">League\CommonMark\Normalizer\TextNormalizerInterface</span><span class="p">;</span>

<span class="k">final</span> <span class="kd">class</span> <span class="nc">MD5Normalizer</span> <span class="kd">implements</span> <span class="nc">TextNormalizerInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">normalize</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$text</span><span class="p">,</span> <span class="nv">$context</span> <span class="o">=</span> <span class="kc">null</span><span class="p">):</span> <span class="kt">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$text</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And then configure it like this:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$config</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'slug_normalizer'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="c1">// ... other options here ...</span>
        <span class="s1">'instance'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nc">MD5Normalizer</span><span class="p">(),</span>
    <span class="p">],</span>
<span class="p">];</span>
</code></pre></div></div>

<p>Or you could use <a href="https://www.php.net/manual/en/language.oop5.anonymous.php">PHP’s anonymous class feature</a> to define the generator’s behavior without creating a new class file:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$config</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'slug_normalizer'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="c1">// ... other options here ...</span>
        <span class="s1">'instance'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="kd">class</span> <span class="kd">implements</span> <span class="nc">TextNormalizerInterface</span> <span class="p">{</span>
            <span class="k">public</span> <span class="k">function</span> <span class="n">normalize</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$text</span><span class="p">,</span> <span class="nv">$context</span> <span class="o">=</span> <span class="kc">null</span><span class="p">):</span> <span class="kt">string</span>
            <span class="p">{</span>
                <span class="c1">// TODO: Implement your code here</span>
            <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">];</span>
</code></pre></div></div>

<h3 id="max_length"><code class="language-plaintext highlighter-rouge">max_length</code></h3>

<p>This can be configured to limit the length of that slug to prevent overly-long values. By default, that limit is <code class="language-plaintext highlighter-rouge">255</code> characters. You may set this to any positive integer, or <code class="language-plaintext highlighter-rouge">0</code> for no limit.</p>

<p>(Note that generated slugs might be slightly longer than this “limit” if the <code class="language-plaintext highlighter-rouge">unique</code> option is enabled and the slug generator detects a duplicate slug and needs to add a suffix to make it unique.)</p>

<h3 id="unique"><code class="language-plaintext highlighter-rouge">unique</code></h3>

<p>This options controls whether slugs should be unique.  Possible values include:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">'document'</code> (string; <strong>default</strong>) - Ensures slugs are unique within a single document</li>
  <li><code class="language-plaintext highlighter-rouge">'environment'</code> (string) - Ensures slugs are unique across multiple documents - see below</li>
  <li><code class="language-plaintext highlighter-rouge">false</code> (boolean) - Disables unique slug generation</li>
</ul>

<p>You might have a use case where you’re converting several different Markdown documents on the same page and so you’d like to ensure that none of those documents use conflicting slugs.  In that case, you should set the <code class="language-plaintext highlighter-rouge">scope</code> option to <code class="language-plaintext highlighter-rouge">'environment'</code> to ensure that a single instance of a <code class="language-plaintext highlighter-rouge">MarkdownConverter</code> (which uses a single <code class="language-plaintext highlighter-rouge">Environment</code>) will never produce the same slug twice during its lifetime (which usually lasts the entire duration of a single HTTP request).</p>

<p>If you need complete control over how unique slugs are generated, make your <code class="language-plaintext highlighter-rouge">'instance'</code> implement <code class="language-plaintext highlighter-rouge">UniqueSlugNormalizerInterface</code>; otherwise, we’ll simply append incremental numbers to slugs to ensure they are unique.</p>


        <hr>

        <p>
            <a class="btn btn-sm btn-black" href="https://github.com/thephpleague/commonmark/edit/2.7/docs/2.5/customization/slug-normalizer.md" title="Edit this page on GitHub" target="_blank" rel="noopener"><i class="fas fa-edit"></i> Edit this page</a>
        </p>
    </article>

    <aside class="support-banner-wrapper" x-data="{ show: false }" x-show.transition="show" x-init="h = localStorage.getItem('hideBanner'); (h === null || h < (new Date().getTime())) ? (setTimeout(() => show = true, 500)) : (show = false)">
        <div class="support-banner">
            <p class="support-banner-left">
                <strong>Love PHP Commonmark?</strong>
                <span class="hidden sm:inline-block lg:hidden">
                    Show your support!
                </span>

                <span class="hidden lg:inline-block">
                    Support development via monthly sponsorship or a one-time donation!
                </span>
            </p>

            <div class="support-banner-right">
                <a href="https://github.com/sponsors/colinodell" class="btn btn-pink btn-block">
                    <i class="fas fa-heart fa-fw" aria-hidden="true"></i> Sponsor
                </a>

                <a href="https://www.paypal.me/colinpodell/10.00" class="btn btn-green btn-block">
                    <i class="fas fa-donate fa-fw" aria-hidden="true"></i> Donate
                </a>
            </div>

            <button x-on:click="localStorage.setItem('hideBanner', new Date().getTime() + (7*24*60*60*1000)); show = false" class="support-banner-close">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
    </aside>
</main>

<footer>
    <span>&copy; Copyright <a href="https://www.colinodell.com">Colin O'Dell</a> &amp; <a href="//thephpleague.com">The League of Extraordinary Packages</a>.</span>
    <span>Site design by <a href="//reinink.ca">Jonathan Reinink</a> and <a href="//nyamsprod.com">Ignace Nyamagana Butera</a>.</span>
</footer>
<script src="/custom.js?"></script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
<script> docsearch({
    apiKey: 'f8a60b0120292f75f23d313f6cebba05',
    appId: '5WPQI5503X',
    indexName: 'commonmark-thephpleague',
    inputSelector: '#doc-search',
    algoliaOptions: { 'facetFilters': ["version:v2.5"] },
    debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
