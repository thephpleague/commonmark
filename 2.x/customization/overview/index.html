




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <meta name="description" content="An overview of the powerful customization features">
    
    <meta name="docsearch:version" content="2.x">
    
        <title>Customization Overview - CommonMark for PHP</title>
    
    <link rel="icon" type="image/x-icon" href="//theme.thephpleague.com/img/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" href="//theme.thephpleague.com/img/apple-touch-icon-precomposed.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@thephpleague" />
    <meta name="twitter:creator" content="@colinodell" />
    <meta property="og:url" content="https://commonmark.thephpleague.com/2.x/customization/overview/" />
    
        <meta property="og:title" content="Customization Overview - CommonMark for PHP" />
    
    
        <meta property="og:description" content="An overview of the powerful customization features" />
    
    <meta property="og:image" content="https://commonmark.thephpleague.com/images/commonmark-social.png" />
    <link rel="stylesheet" href="//theme.thephpleague.com/css/all.css?">
    <link rel="stylesheet" href="/custom.css?">
    <link rel="stylesheet" href="/global.css?">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <link rel="stylesheet" href="/support.css?">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-137970568-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-137970568-1');
    </script>
</head>
<body>
<header>
    <div class="header-content">
        <h1 class="title">
            <a class="logo" href="/">
            <span class="name">
                <em>League\</em>CommonMark
            </span>
            </a>
        </h1>
        <div class="search"><input type="search" id="doc-search" placeholder="search the docs..."></div>
        <nav class="versions">
            <h2>v2.x &#9662;</h2>
            <ul>
            
                <li class="selected"><a href="/2.x/customization/overview/">v2.x</a></li>
            
                <li ><a href="/1.x/">v1.x</a></li>
            
                <li ><a href="/releases/">Notes</a></li>
            </ul>
        </nav>
    </div>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776;</div>
    <div class="open">&#10799;</div>
</label>

<main>
    <menu>
        <div class="versions-small">
        <h2>Versions</h2>
            <ul>
        
                <li class="selected">
                    <a href="/2.x/">2.x</a>
                </li>
        
                <li >
                    <a href="/1.x/">1.x</a>
                </li>
        
                <li ><a href="/releases/">Releases Notes</a></li>
            </ul>
        </div>

        
            
            <div class="menu-section">
                <h2>Getting Started</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/upgrading/">Upgrading</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/changelog/">Changelog</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/support/">Support</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Usage</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/basic-usage/">Basic Usage</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/xml/">XML</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Extensions</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/extensions/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/commonmark/">CommonMark</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/github-flavored-markdown/">GitHub-Flavored Markdown</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/attributes/">Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/autolinks/">Autolinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/default-attributes/">Default Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/description-lists/">Description Lists</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/disallowed-raw-html/">Disallowed Raw HTML</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/embed/">Embed</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/external-links/">External Links</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/footnotes/">Footnotes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/front-matter/">Front Matter</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/heading-permalinks/">Heading Permalinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/highlight/">Highlight</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/inlines-only/">Inlines Only</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/mentions/">Mentions</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/smart-punctuation/">Smart Punctuation</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/strikethrough/">Strikethrough</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/table-of-contents/">Table of Contents</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/tables/">Tables</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/task-lists/">Task Lists</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Customization</h2>
                <ul>
                    
                        <li class="selected">
                            <a href="/2.x/customization/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/environment/">Environment</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/extensions/">Extensions</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/event-dispatcher/">Event Dispatcher</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/cursor/">Cursor</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/block-parsing/">Block Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/inline-parsing/">Inline Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/delimiter-processing/">Delimiter Processing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/abstract-syntax-tree/">Abstract Syntax Tree</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/rendering/">Rendering</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/slug-normalizer/">Slug Normalizer</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/disabling-features/">Disabling Features</a>
                        </li>
                    
                </ul>
            </div>
            
        
    </menu>
    <article>
    

    

    

        <h1 id="customization-overview">Customization Overview</h1>

<p>Ready to go beyond the basics of converting Markdown to HTML? This page describes some of the more advanced things you can customize this library to do.</p>

<h2 id="parsing-and-rendering">Parsing and Rendering</h2>

<p>The actual process of converting Markdown to HTML has several steps:</p>

<ol>
  <li>Create an <a href="/2.x/customization/environment/"><code class="language-plaintext highlighter-rouge">Environment</code></a>, adding whichever extensions/parser/renders/configuration you need</li>
  <li>Instantiate a <code class="language-plaintext highlighter-rouge">MarkdownParser</code> and <code class="language-plaintext highlighter-rouge">HtmlRenderer</code> using that <code class="language-plaintext highlighter-rouge">Environment</code></li>
  <li>Use the <code class="language-plaintext highlighter-rouge">MarkdownParser</code> to parse the Markdown input into an <a href="/2.x/customization/abstract-syntax-tree/">Abstract Syntax Tree</a> (aka an “AST”)</li>
  <li>Use the <code class="language-plaintext highlighter-rouge">HtmlRenderer</code> to convert the <a href="/2.x/customization/abstract-syntax-tree/#document">AST <code class="language-plaintext highlighter-rouge">Document</code></a> into HTML</li>
</ol>

<p>The <code class="language-plaintext highlighter-rouge">MarkdownConverter</code> class handles all of this for you, but you can execute that process yourself if you wish:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">League\CommonMark\Parser\MarkdownParser</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Environment\Environment</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Renderer\HtmlRenderer</span><span class="p">;</span>

<span class="nv">$environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Environment</span><span class="p">([</span>
    <span class="s1">'html_input'</span> <span class="o">=&gt;</span> <span class="s1">'strip'</span><span class="p">,</span>
<span class="p">]);</span>
<span class="nv">$environment</span><span class="o">-&gt;</span><span class="nf">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nc">CommonMarkCoreExtension</span><span class="p">());</span>

<span class="nv">$parser</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MarkdownParser</span><span class="p">(</span><span class="nv">$environment</span><span class="p">);</span>
<span class="nv">$htmlRenderer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HtmlRenderer</span><span class="p">(</span><span class="nv">$environment</span><span class="p">);</span>

<span class="nv">$markdown</span> <span class="o">=</span> <span class="s1">'# Hello World!'</span><span class="p">;</span>

<span class="nv">$document</span> <span class="o">=</span> <span class="nv">$parser</span><span class="o">-&gt;</span><span class="nf">parse</span><span class="p">(</span><span class="nv">$markdown</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$htmlRenderer</span><span class="o">-&gt;</span><span class="nf">renderDocument</span><span class="p">(</span><span class="nv">$document</span><span class="p">);</span>

<span class="c1">// &lt;h1&gt;Hello World!&lt;/h1&gt;</span>
</code></pre></div></div>

<p>Feel free to swap out different components or add your own steps in between.  However, the best way to customize this library is to <a href="/2.x/customization/extensions/">create your own extensions</a> which hook into the parsing and rendering steps - continue reading to see which kinds of extension points are available to you.</p>

<h2 id="add-custom-syntax-with-parsers">Add Custom Syntax with Parsers</h2>

<p>Parsers examine the Markdown input and produce an abstract syntax tree (AST) of the document’s structure.
This resulting AST contains both blocks (structural elements like paragraphs, lists, headers, etc) and inlines (words, spaces, links, emphasis, etc).</p>

<p>There are two main types of parsers:</p>

<ul>
  <li><a href="/2.x/customization/block-parsing/">Block parsers</a></li>
  <li><a href="/2.x/customization/inline-parsing/">Inline parsers</a></li>
</ul>

<p>The parsing approach is identical for both types - examine text at the current position (via the <a href="/2.x/customization/cursor/"><code class="language-plaintext highlighter-rouge">Cursor</code></a>) and determine if you can handle it;
if so, create the corresponding AST element,
otherwise you abort and the engine will try other parsers.  If no parser succeeds then the current text is treated as plain text.</p>

<p>Simple delimiter-based inlines (like emphasis, strikethrough, etc.) can be parsed without needing a dedicated inline parser by leveraging the new <a href="/2.x/customization/delimiter-processing/">Delimiter Processing</a> functionality.</p>

<h2 id="ast-manipulation">AST manipulation</h2>

<p>Once the <a href="/2.x/customization/abstract-syntax-tree/">Abstract Syntax Tree</a> is parsed, you are free to access/manipulate it as needed before it’s passed into the rendering engine.</p>

<h2 id="customize-html-output-with-custom-renderers">Customize HTML Output with Custom Renderers</h2>

<p><a href="/2.x/customization/rendering/">Renderers</a> convert the parsed blocks/inlines from the AST representation into HTML. When registering these with the environment, you must tell it which block/inline classes it should handle.  This allows you to essentially “swap out” built-in renderers with your own.</p>

<h2 id="examples">Examples</h2>

<p>Some examples of what’s possible:</p>

<ul>
  <li><a href="/2.x/customization/inline-parsing#example-1---twitter-handles">Parse Twitter handles into profile links</a></li>
  <li><a href="/2.x/customization/inline-parsing#example-2---emoticons">Convert smilies into emoticon images</a></li>
</ul>


        <hr>

        <p>
            <a class="btn btn-sm btn-black" href="https://github.com/thephpleague/commonmark/edit/2.x/docs/2.x/customization/overview.md" title="Edit this page on GitHub" target="_blank" rel="noopener"><i class="fas fa-edit"></i> Edit this page</a>
        </p>
    </article>

    <aside class="support-banner-wrapper" x-data="{ show: false }" x-show.transition="show" x-init="h = localStorage.getItem('hideBanner'); (h === null || h < (new Date().getTime())) ? (setTimeout(() => show = true, 500)) : (show = false)">
        <div class="support-banner">
            <p class="support-banner-left">
                <strong>Love PHP Commonmark?</strong>
                <span class="hidden sm:inline-block lg:hidden">
                    Show your support!
                </span>

                <span class="hidden lg:inline-block">
                    Support development via monthly sponsorship or a one-time donation!
                </span>
            </p>

            <div class="support-banner-right">
                <a href="https://github.com/sponsors/colinodell" class="btn btn-pink btn-block">
                    <i class="fas fa-heart fa-fw" aria-hidden="true"></i> Sponsor
                </a>

                <a href="https://www.paypal.me/colinpodell/10.00" class="btn btn-green btn-block">
                    <i class="fas fa-donate fa-fw" aria-hidden="true"></i> Donate
                </a>
            </div>

            <button x-on:click="localStorage.setItem('hideBanner', new Date().getTime() + (7*24*60*60*1000)); show = false" class="support-banner-close">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
    </aside>
</main>

<footer>
    <span>&copy; Copyright <a href="https://www.colinodell.com">Colin O'Dell</a> &amp; <a href="//thephpleague.com">The League of Extraordinary Packages</a>.</span>
    <span>Site design by <a href="//reinink.ca">Jonathan Reinink</a> and <a href="//nyamsprod.com">Ignace Nyamagana Butera</a>.</span>
</footer>
<script src="/custom.js?"></script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
<script> docsearch({
    apiKey: 'f8a60b0120292f75f23d313f6cebba05',
    appId: '5WPQI5503X',
    indexName: 'commonmark-thephpleague',
    inputSelector: '#doc-search',
    algoliaOptions: { 'facetFilters': ["version:v2.x"] },
    debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
