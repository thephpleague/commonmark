




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <meta name="description" content="The EmbedExtension supports embedding rich content from other websites.">
    
    <meta name="docsearch:version" content="2.x">
    
        <title>Embed Extension - CommonMark for PHP</title>
    
    <link rel="icon" type="image/x-icon" href="//theme.thephpleague.com/img/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" href="//theme.thephpleague.com/img/apple-touch-icon-precomposed.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@thephpleague" />
    <meta name="twitter:creator" content="@colinodell" />
    <meta property="og:url" content="https://commonmark.thephpleague.com/2.x/extensions/embed/" />
    
        <meta property="og:title" content="Embed Extension - CommonMark for PHP" />
    
    
        <meta property="og:description" content="The EmbedExtension supports embedding rich content from other websites." />
    
    <meta property="og:image" content="https://commonmark.thephpleague.com/images/commonmark-social.png" />
    <link rel="stylesheet" href="//theme.thephpleague.com/css/all.css?">
    <link rel="stylesheet" href="/custom.css?">
    <link rel="stylesheet" href="/global.css?">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <link rel="stylesheet" href="/support.css?">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-137970568-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-137970568-1');
    </script>
</head>
<body>
<header>
    <div class="header-content">
        <h1 class="title">
            <a class="logo" href="/">
            <span class="name">
                <em>League\</em>CommonMark
            </span>
            </a>
        </h1>
        <div class="search"><input type="search" id="doc-search" placeholder="search the docs..."></div>
        <nav class="versions">
            <h2>v2.x &#9662;</h2>
            <ul>
            
                <li class="selected"><a href="/2.x/extensions/embed/">v2.x</a></li>
            
                <li ><a href="/1.x/">v1.x</a></li>
            
                <li ><a href="/releases/">Notes</a></li>
            </ul>
        </nav>
    </div>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776;</div>
    <div class="open">&#10799;</div>
</label>

<main>
    <menu>
        <div class="versions-small">
        <h2>Versions</h2>
            <ul>
        
                <li class="selected">
                    <a href="/2.x/">2.x</a>
                </li>
        
                <li >
                    <a href="/1.x/">1.x</a>
                </li>
        
                <li ><a href="/releases/">Releases Notes</a></li>
            </ul>
        </div>

        
            
            <div class="menu-section">
                <h2>Getting Started</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/upgrading/">Upgrading</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/changelog/">Changelog</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/support/">Support</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Usage</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/basic-usage/">Basic Usage</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/xml/">XML</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Extensions</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/extensions/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/commonmark/">CommonMark</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/github-flavored-markdown/">GitHub-Flavored Markdown</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/attributes/">Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/autolinks/">Autolinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/default-attributes/">Default Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/description-lists/">Description Lists</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/disallowed-raw-html/">Disallowed Raw HTML</a>
                        </li>
                    
                        <li class="selected">
                            <a href="/2.x/extensions/embed/">Embed</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/external-links/">External Links</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/footnotes/">Footnotes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/front-matter/">Front Matter</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/heading-permalinks/">Heading Permalinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/highlight/">Highlight</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/inlines-only/">Inlines Only</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/mentions/">Mentions</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/smart-punctuation/">Smart Punctuation</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/strikethrough/">Strikethrough</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/table-of-contents/">Table of Contents</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/tables/">Tables</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/task-lists/">Task Lists</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Customization</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/customization/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/environment/">Environment</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/extensions/">Extensions</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/event-dispatcher/">Event Dispatcher</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/cursor/">Cursor</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/block-parsing/">Block Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/inline-parsing/">Inline Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/delimiter-processing/">Delimiter Processing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/abstract-syntax-tree/">Abstract Syntax Tree</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/rendering/">Rendering</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/slug-normalizer/">Slug Normalizer</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/disabling-features/">Disabling Features</a>
                        </li>
                    
                </ul>
            </div>
            
        
    </menu>
    <article>
    

    

    

        <h1 id="embed-extension">Embed Extension</h1>

<p>This extension can embed rich content (like videos, tweets, etc.) from other websites.</p>

<p>The syntax is very simple - simply place any <code class="language-plaintext highlighter-rouge">https://</code> URL on its own line like this:</p>

<div class="language-md highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Check out this video!

https://www.youtube.com/watch?v=dQw4w9WgXcQ
</code></pre></div></div>

<p>If the link points to embeddable content, it will be replaced with the rich HTML needed to embed it:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;</span>Check out this video:<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">"200"</span> <span class="na">height=</span><span class="s">"113"</span> <span class="na">src=</span><span class="s">"https://www.youtube.com/embed/dQw4w9WgXcQ?feature=oembed"</span> <span class="na">frameborder=</span><span class="s">"0"</span> <span class="na">allow=</span><span class="s">"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"</span> <span class="na">allowfullscreen</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</code></pre></div></div>

<h2 id="installation">Installation</h2>

<p>This extension is bundled with <code class="language-plaintext highlighter-rouge">league/commonmark</code>. This library can be installed via Composer:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require league/commonmark
</code></pre></div></div>

<p>You’ll also need to install a third-party <a href="https://www.oembed.com/">OEmbed</a> library - see the <a href="#adapter"><strong>Adapter</strong></a> section below.</p>

<h2 id="usage">Usage</h2>

<p>Configure your <code class="language-plaintext highlighter-rouge">Environment</code> as usual and add the <code class="language-plaintext highlighter-rouge">EmbedExtension</code> provided by this package:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Embed\Embed</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Environment\Environment</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Extension\CommonMark\CommonMarkCoreExtension</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Extension\Embed\EmbedExtension</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\MarkdownConverter</span><span class="p">;</span>

<span class="c1">// Define your configuration</span>
<span class="nv">$config</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'embed'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'adapter'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nc">OscaroteroEmbedAdapter</span><span class="p">(),</span> <span class="c1">// See the "Adapter" documentation below</span>
        <span class="s1">'allowed_domains'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'youtube.com'</span><span class="p">,</span> <span class="s1">'twitter.com'</span><span class="p">,</span> <span class="s1">'github.com'</span><span class="p">],</span>
        <span class="s1">'fallback'</span> <span class="o">=&gt;</span> <span class="s1">'link'</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">];</span>

<span class="c1">// Configure the Environment with all whatever other extensions you want</span>
<span class="nv">$environment</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Environment</span><span class="p">(</span><span class="nv">$config</span><span class="p">);</span>
<span class="nv">$environment</span><span class="o">-&gt;</span><span class="nf">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nc">CommonMarkCoreExtension</span><span class="p">());</span>

<span class="c1">// Add this extension</span>
<span class="nv">$environment</span><span class="o">-&gt;</span><span class="nf">addExtension</span><span class="p">(</span><span class="k">new</span> <span class="nc">EmbedExtension</span><span class="p">());</span>

<span class="c1">// Instantiate the converter engine and start converting some Markdown!</span>
<span class="nv">$converter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MarkdownConverter</span><span class="p">(</span><span class="nv">$environment</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$converter</span><span class="o">-&gt;</span><span class="nf">convert</span><span class="p">(</span><span class="s1">'https://www.youtube.com/watch?v=dQw4w9WgXcQ'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="configuration">Configuration</h2>

<p>This extension supports the following configuration options under the <code class="language-plaintext highlighter-rouge">embed</code> configuration:</p>

<h3 id="adapter-option"><code class="language-plaintext highlighter-rouge">adapter</code> option</h3>

<p>Any instance of <code class="language-plaintext highlighter-rouge">EmbedAdapterInterface</code> - see the “<strong><a href="#adapter">Adapter</a></strong>” section below.</p>

<h3 id="allowed_domains-option"><code class="language-plaintext highlighter-rouge">allowed_domains</code> option</h3>

<p>This option defines a list of hosts that you wish to allow embedding content from. For example, setting this to
<code class="language-plaintext highlighter-rouge">['youtube.com']</code> would only allow videos from YouTube to be embedded.
It’s extremely important that you only include websites you trust since they’ll be providing HTML that is directly embedded in your website.</p>

<p>Any subdomains of these domains will also be allowed. For example, <code class="language-plaintext highlighter-rouge">['youtube.com']</code> would allow embedding from <code class="language-plaintext highlighter-rouge">youtube.com</code> or <code class="language-plaintext highlighter-rouge">www.youtube.com</code>.</p>

<p>As an additional safety measure, we recommend that you also use a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy (CSP)</a>
to prevent unexpected content from being embedded.</p>

<p>By default, this option is an empty array (<code class="language-plaintext highlighter-rouge">[]</code>), which means that all domains are allowed.</p>

<h3 id="fallback-option"><code class="language-plaintext highlighter-rouge">fallback</code> option</h3>

<p>This options defines the behavior when a URL cannot be embedded, either because it’s not in the list of <code class="language-plaintext highlighter-rouge">allowed_domains</code>,
or because the <code class="language-plaintext highlighter-rouge">adapter</code> could not find embeddable content for that URL.</p>

<p>There are two possible values for this option:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">'link'</code> - the URL will be kept in the document as a link (<strong>default</strong>)
-<code class="language-plaintext highlighter-rouge">'remove'</code> - the URL will be completely removed from the document</li>
</ul>

<h2 id="adapter">Adapter</h2>

<p><code class="language-plaintext highlighter-rouge">league/commonmark</code> doesn’t know how to obtain the embeddable HTML for a given URL - this must be done by an external library.</p>

<h3 id="embedembed-adapter"><code class="language-plaintext highlighter-rouge">embed/embed</code> Adapter</h3>

<p>We do provide an adapter for the popular <a href="https://github.com/oscarotero/Embed"><code class="language-plaintext highlighter-rouge">embed/embed</code></a> library. if you’d like to use that.  We like this library
because it supports fetching multiple URLs in parallel, which is ideal for performance, and it supports a wide range
of embeddable content.</p>

<p>To use that library, you’ll need to <code class="language-plaintext highlighter-rouge">composer require embed/embed</code> and then pass <code class="language-plaintext highlighter-rouge">new OscaroteroEmbedAdapter()</code> as the <code class="language-plaintext highlighter-rouge">adapter</code>
configuration option, as shown in the <a href="#usage"><strong>Usage</strong></a> section above.</p>

<p>Note: <code class="language-plaintext highlighter-rouge">embed/embed</code> <em>requires</em> a PSR-17 implementation to be installed.  If you do not have one installed, the library will not work.  By default these libraries are detected automatically:</p>

<ul>
  <li><a href="https://github.com/laminas/laminas-diactoros">laminas/laminas-diactoros</a></li>
  <li><a href="https://github.com/guzzle/psr7">guzzle/psr7</a></li>
  <li><a href="https://github.com/Nyholm/psr7">nyholm/psr7</a></li>
  <li><a href="https://github.com/sunrise-php/http-message">sunrise/http-message</a></li>
</ul>

<p>Need to customize the maximum width/height of the embedded content? You can do that by instantiating the service provided by
<code class="language-plaintext highlighter-rouge">embed/embed</code>, <a href="https://github.com/oscarotero/Embed#settings">configuring it as needed</a>, and passing that customized instance into the adapter:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">use</span> <span class="nc">Embed\Embed</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">League\CommonMark\Extension\Embed\Bridge\OscaroteroEmbedAdapter</span><span class="p">;</span>

<span class="c1">// Configure the Embed library itself</span>
<span class="nv">$embedLibrary</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Embed</span><span class="p">();</span>
<span class="nv">$embedLibrary</span><span class="o">-&gt;</span><span class="nf">setSettings</span><span class="p">([</span>
    <span class="s1">'oembed:query_parameters'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'maxwidth'</span> <span class="o">=&gt;</span> <span class="mi">800</span><span class="p">,</span>
        <span class="s1">'maxheight'</span> <span class="o">=&gt;</span> <span class="mi">600</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'twitch:parent'</span> <span class="o">=&gt;</span> <span class="s1">'example.com'</span><span class="p">,</span>
    <span class="s1">'facebook:token'</span> <span class="o">=&gt;</span> <span class="s1">'1234|5678'</span><span class="p">,</span>
    <span class="s1">'instagram:token'</span> <span class="o">=&gt;</span> <span class="s1">'1234|5678'</span><span class="p">,</span>
    <span class="s1">'twitter:token'</span> <span class="o">=&gt;</span> <span class="s1">'asdf'</span><span class="p">,</span>
<span class="p">]);</span>

<span class="c1">// Inject it into our adapter</span>
<span class="nv">$config</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">'adapter'</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nc">OscaroteroEmbedAdapter</span><span class="p">(</span><span class="nv">$embedLibrary</span><span class="p">),</span>
<span class="p">];</span>

<span class="c1">// Instantiate your CommonMark environment and converter like usual</span>
<span class="c1">// ...</span>
</code></pre></div></div>

<h3 id="custom-adapter">Custom Adapter</h3>

<p>If you prefer to use a different library, you’ll need to implement our <code class="language-plaintext highlighter-rouge">EmbedAdapterInterface</code> yourself with
<a href="https://packagist.org/?tags=oembed">whatever OEmbed library</a> you choose.</p>

<h2 id="tips">Tips</h2>

<p>If you need to wrap the HTML in a container tag, consider using the <a href="/2.x/customization/rendering/#wrapping-elements-with-htmldecorator"><code class="language-plaintext highlighter-rouge">HtmlDecorator</code> renderer</a>:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$environment</span><span class="o">-&gt;</span><span class="nf">addRenderer</span><span class="p">(</span><span class="nc">Embed</span><span class="o">::</span><span class="n">class</span><span class="p">,</span> <span class="k">new</span> <span class="nc">HtmlDecorator</span><span class="p">(</span><span class="k">new</span> <span class="nc">EmbedRenderer</span><span class="p">(),</span> <span class="s1">'div'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'class'</span> <span class="o">=&gt;</span> <span class="s1">'embeded-content'</span><span class="p">]));</span>
</code></pre></div></div>


        <hr>

        <p>
            <a class="btn btn-sm btn-black" href="https://github.com/thephpleague/commonmark/edit/2.x/docs/2.x/extensions/embed.md" title="Edit this page on GitHub" target="_blank" rel="noopener"><i class="fas fa-edit"></i> Edit this page</a>
        </p>
    </article>

    <aside class="support-banner-wrapper" x-data="{ show: false }" x-show.transition="show" x-init="h = localStorage.getItem('hideBanner'); (h === null || h < (new Date().getTime())) ? (setTimeout(() => show = true, 500)) : (show = false)">
        <div class="support-banner">
            <p class="support-banner-left">
                <strong>Love PHP Commonmark?</strong>
                <span class="hidden sm:inline-block lg:hidden">
                    Show your support!
                </span>

                <span class="hidden lg:inline-block">
                    Support development via monthly sponsorship or a one-time donation!
                </span>
            </p>

            <div class="support-banner-right">
                <a href="https://github.com/sponsors/colinodell" class="btn btn-pink btn-block">
                    <i class="fas fa-heart fa-fw" aria-hidden="true"></i> Sponsor
                </a>

                <a href="https://www.paypal.me/colinpodell/10.00" class="btn btn-green btn-block">
                    <i class="fas fa-donate fa-fw" aria-hidden="true"></i> Donate
                </a>
            </div>

            <button x-on:click="localStorage.setItem('hideBanner', new Date().getTime() + (7*24*60*60*1000)); show = false" class="support-banner-close">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
    </aside>
</main>

<footer>
    <span>&copy; Copyright <a href="https://www.colinodell.com">Colin O'Dell</a> &amp; <a href="//thephpleague.com">The League of Extraordinary Packages</a>.</span>
    <span>Site design by <a href="//reinink.ca">Jonathan Reinink</a> and <a href="//nyamsprod.com">Ignace Nyamagana Butera</a>.</span>
</footer>
<script src="/custom.js?"></script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
<script> docsearch({
    apiKey: 'f8a60b0120292f75f23d313f6cebba05',
    appId: '5WPQI5503X',
    indexName: 'commonmark-thephpleague',
    inputSelector: '#doc-search',
    algoliaOptions: { 'facetFilters': ["version:v2.x"] },
    debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
