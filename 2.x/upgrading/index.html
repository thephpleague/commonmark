




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <meta name="description" content="Guide to upgrading to newer versions of this library">
    
    <meta name="docsearch:version" content="2.x">
    
        <title>Upgrading to Newer Versions - CommonMark for PHP</title>
    
    <link rel="icon" type="image/x-icon" href="//theme.thephpleague.com/img/favicon.ico" />
    <link rel="apple-touch-icon-precomposed" href="//theme.thephpleague.com/img/apple-touch-icon-precomposed.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@thephpleague" />
    <meta name="twitter:creator" content="@colinodell" />
    <meta property="og:url" content="https://commonmark.thephpleague.com/2.x/upgrading/" />
    
        <meta property="og:title" content="Upgrading to Newer Versions - CommonMark for PHP" />
    
    
        <meta property="og:description" content="Guide to upgrading to newer versions of this library" />
    
    <meta property="og:image" content="https://commonmark.thephpleague.com/images/commonmark-social.png" />
    <link rel="stylesheet" href="//theme.thephpleague.com/css/all.css?">
    <link rel="stylesheet" href="/custom.css?">
    <link rel="stylesheet" href="/global.css?">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
    <link rel="stylesheet" href="/support.css?">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-137970568-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-137970568-1');
    </script>
</head>
<body>
<header>
    <div class="header-content">
        <h1 class="title">
            <a class="logo" href="/">
            <span class="name">
                <em>League\</em>CommonMark
            </span>
            </a>
        </h1>
        <div class="search"><input type="search" id="doc-search" placeholder="search the docs..."></div>
        <nav class="versions">
            <h2>v2.x &#9662;</h2>
            <ul>
            
                <li class="selected"><a href="/2.x/upgrading/">v2.x</a></li>
            
                <li ><a href="/1.x/">v1.x</a></li>
            
                <li ><a href="/releases/">Notes</a></li>
            </ul>
        </nav>
    </div>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776;</div>
    <div class="open">&#10799;</div>
</label>

<main>
    <menu>
        <div class="versions-small">
        <h2>Versions</h2>
            <ul>
        
                <li class="selected">
                    <a href="/2.x/">2.x</a>
                </li>
        
                <li >
                    <a href="/1.x/">1.x</a>
                </li>
        
                <li ><a href="/releases/">Releases Notes</a></li>
            </ul>
        </div>

        
            
            <div class="menu-section">
                <h2>Getting Started</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/installation/">Installation</a>
                        </li>
                    
                        <li class="selected">
                            <a href="/2.x/upgrading/">Upgrading</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/changelog/">Changelog</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/support/">Support</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Usage</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/basic-usage/">Basic Usage</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/xml/">XML</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Extensions</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/extensions/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/commonmark/">CommonMark</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/github-flavored-markdown/">GitHub-Flavored Markdown</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/attributes/">Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/autolinks/">Autolinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/default-attributes/">Default Attributes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/description-lists/">Description Lists</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/disallowed-raw-html/">Disallowed Raw HTML</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/embed/">Embed</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/external-links/">External Links</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/footnotes/">Footnotes</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/front-matter/">Front Matter</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/heading-permalinks/">Heading Permalinks</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/highlight/">Highlight</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/inlines-only/">Inlines Only</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/mentions/">Mentions</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/smart-punctuation/">Smart Punctuation</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/strikethrough/">Strikethrough</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/table-of-contents/">Table of Contents</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/tables/">Tables</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/extensions/task-lists/">Task Lists</a>
                        </li>
                    
                </ul>
            </div>
            
            <div class="menu-section">
                <h2>Customization</h2>
                <ul>
                    
                        <li >
                            <a href="/2.x/customization/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/environment/">Environment</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/extensions/">Extensions</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/event-dispatcher/">Event Dispatcher</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/cursor/">Cursor</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/block-parsing/">Block Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/inline-parsing/">Inline Parsing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/delimiter-processing/">Delimiter Processing</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/abstract-syntax-tree/">Abstract Syntax Tree</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/rendering/">Rendering</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/slug-normalizer/">Slug Normalizer</a>
                        </li>
                    
                        <li >
                            <a href="/2.x/customization/disabling-features/">Disabling Features</a>
                        </li>
                    
                </ul>
            </div>
            
        
    </menu>
    <article>
    

    

    

        <h1 id="upgrading-to-newer-versions">Upgrading to Newer Versions</h1>

<h2 id="upgrading-from-27-to-28">Upgrading from 2.7 to 2.8</h2>

<p>There are no breaking changes when upgrading from 2.7 to 2.8.</p>

<h2 id="upgrading-from-26-to-27">Upgrading from 2.6 to 2.7</h2>

<p>There are no breaking changes when upgrading from 2.6 to 2.7.</p>

<h2 id="upgrading-from-25-to-26">Upgrading from 2.5 to 2.6</h2>

<h3 id="max_delimiters_per_line-configuration-option"><code class="language-plaintext highlighter-rouge">max_delimiters_per_line</code> Configuration Option</h3>

<p>The <code class="language-plaintext highlighter-rouge">max_delimiters_per_line</code> configuration option was added in 2.6 to help protect against malicious input that could
cause excessive memory usage or denial of service attacks.  It defaults to <code class="language-plaintext highlighter-rouge">PHP_INT_MAX</code> (no limit) for backwards
compatibility, which is safe when parsing trusted input. However, if you’re parsing untrusted input from users, you
should probably set this to a reasonable value (somewhere between <code class="language-plaintext highlighter-rouge">100</code> and <code class="language-plaintext highlighter-rouge">1000</code>) to protect against malicious inputs.</p>

<h3 id="custom-delimiter-processors">Custom Delimiter Processors</h3>

<p>If you’re implementing a custom delimiter processor, and <code class="language-plaintext highlighter-rouge">getDelimiterUse()</code> has more logic than just a
simple <code class="language-plaintext highlighter-rouge">return</code> statement, you should implement <code class="language-plaintext highlighter-rouge">CacheableDelimiterProcessorInterface</code> instead of
<code class="language-plaintext highlighter-rouge">DelimiterProcessorInterface</code> to improve performance and avoid possible quadratic performance issues.</p>

<p><code class="language-plaintext highlighter-rouge">DelimiterProcessorInterface</code> has a <code class="language-plaintext highlighter-rouge">getDelimiterUse()</code> method that tells the engine how many characters from the
matching delimiters should be consumed. Simple processors usually always return a hard-coded integer like <code class="language-plaintext highlighter-rouge">1</code> or <code class="language-plaintext highlighter-rouge">2</code>.
However, some more advanced processors may need to examine the opening and closing delimiters and perform additional
logic to determine whether they should be fully or partially consumed.  Previously, these results could not be safely
cached, resulting in possible quadratic performance issues.</p>

<p>In 2.6, the <code class="language-plaintext highlighter-rouge">CacheableDelimiterProcessorInterface</code> was introduced to allow these “dynamic” processors to be safely
cached. It requires a new <code class="language-plaintext highlighter-rouge">getCacheKey()</code> method that returns a string that uniquely identifies the combination of
factors considered when determining the delimiter use.  This key is then used to cache the results of the search for
a matching delimiter.</p>

<h2 id="upgrading-from-24-to-25">Upgrading from 2.4 to 2.5</h2>

<p>These are no significant changes since 2.4.</p>

<h2 id="upgrading-from-23-to-24">Upgrading from 2.3 to 2.4</h2>

<h3 id="exception-changes">Exception Changes</h3>

<p>Prior to 2.4.0, this library did a poor job of using appropriate exception types and documenting which exceptions could
be thrown. For example, all of the main interfaces said that only <code class="language-plaintext highlighter-rouge">RuntimeException</code> could be thrown, but in reality
other exceptions like <code class="language-plaintext highlighter-rouge">LogicException</code> or <code class="language-plaintext highlighter-rouge">InvalidArgumentException</code> could be thrown in some cases!</p>

<p>This inconsistent behavior and inaccurate documentation has been fixed in 2.4.0 by:</p>

<ul>
  <li>Adding a new <code class="language-plaintext highlighter-rouge">CommonMarkException</code> interface implemented by all exceptions thrown by this library</li>
  <li>Adding several new exception types that implement that interface while also extending from the same base exception
type as that would have been previously thrown.</li>
  <li>Fixing incorrect docblocks about the exception types being thrown</li>
</ul>

<p>If you were previously catching exceptions thrown by this library in your code, you should consider changing your
<code class="language-plaintext highlighter-rouge">catch</code> blocks to either catch <code class="language-plaintext highlighter-rouge">CommonMarkException</code> (for all exceptions) or one of the exception types under the
<code class="language-plaintext highlighter-rouge">League\CommonMark\Exception</code> namespace.</p>

<h2 id="upgrading-from-22-to-23">Upgrading from 2.2 to 2.3</h2>

<h3 id="avoid-deprecated-interface">Avoid deprecated interface</h3>

<p><code class="language-plaintext highlighter-rouge">MarkdownRendererInterface</code> has been deprecated and will be removed in the next major version. Please use <code class="language-plaintext highlighter-rouge">DocumentRendererInterface</code> instead.</p>

<h2 id="upgrading-from-21-to-22">Upgrading from 2.1 to 2.2</h2>

<h3 id="deprecation-of-markdownconverterinterface">Deprecation of <code class="language-plaintext highlighter-rouge">MarkdownConverterInterface</code></h3>

<p>The <code class="language-plaintext highlighter-rouge">MarkdownConverterInterface</code> and its <code class="language-plaintext highlighter-rouge">convertToHtml()</code> method were deprecated in 2.2.0 and will be removed in 3.0.0.
You should switch your implementations to use <code class="language-plaintext highlighter-rouge">ConverterInterface</code> and <code class="language-plaintext highlighter-rouge">convert()</code> instead which provide the same behavior.</p>

<h2 id="upgrading-from-20-to-21">Upgrading from 2.0 to 2.1</h2>

<p>No changes or deprecations were made that require changes to upgrade to the new version.</p>

<h2 id="upgrading-from-16-to-20">Upgrading from 1.6 to 2.0</h2>

<p>Version 2.0 contains <strong>lots</strong> of changes throughout the library.  We’ve split the upgrade guide into three sections to help you better identify the changes that are most relevant to you:</p>

<h3 id="for-consumers">For Consumers</h3>

<p>The <a href="/2.x/upgrading/consumers/">upgrade guide for consumers</a> is relevant for developers who use this library as-is to perform basic conversion of Markdown to HTML.  You might enable some extensions or tweak the configuration settings, but you don’t write your own custom parsers or anything like that.  This condensed upgrade guide therefore only covers the most obvious changes that might impact your usage of this library.</p>

<h3 id="for-integrators">For Integrators</h3>

<p>If you develop open-source software that uses this library, read the <a href="/2.x/upgrading/integrators/">upgrade guide for integrators</a>.  It contains all of the information from the Consumer guide above, but with additional details that may be relevant to you.</p>

<h3 id="for-developers">For Developers</h3>

<p>The <a href="/2.x/upgrading/developers/">upgrade guide for developers</a> is aimed at developers who create custom extensions/parsers/renderers and need to know about all of the under-the-hood changes in 2.x.  It is the most comprehensive guide, containing all of the information from the two guides above, and even more details about the under-the-hood changes that likely impact your customizations.</p>


        <hr>

        <p>
            <a class="btn btn-sm btn-black" href="https://github.com/thephpleague/commonmark/edit/2.x/docs/2.x/upgrading.md" title="Edit this page on GitHub" target="_blank" rel="noopener"><i class="fas fa-edit"></i> Edit this page</a>
        </p>
    </article>

    <aside class="support-banner-wrapper" x-data="{ show: false }" x-show.transition="show" x-init="h = localStorage.getItem('hideBanner'); (h === null || h < (new Date().getTime())) ? (setTimeout(() => show = true, 500)) : (show = false)">
        <div class="support-banner">
            <p class="support-banner-left">
                <strong>Love PHP Commonmark?</strong>
                <span class="hidden sm:inline-block lg:hidden">
                    Show your support!
                </span>

                <span class="hidden lg:inline-block">
                    Support development via monthly sponsorship or a one-time donation!
                </span>
            </p>

            <div class="support-banner-right">
                <a href="https://github.com/sponsors/colinodell" class="btn btn-pink btn-block">
                    <i class="fas fa-heart fa-fw" aria-hidden="true"></i> Sponsor
                </a>

                <a href="https://www.paypal.me/colinpodell/10.00" class="btn btn-green btn-block">
                    <i class="fas fa-donate fa-fw" aria-hidden="true"></i> Donate
                </a>
            </div>

            <button x-on:click="localStorage.setItem('hideBanner', new Date().getTime() + (7*24*60*60*1000)); show = false" class="support-banner-close">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
    </aside>
</main>

<footer>
    <span>&copy; Copyright <a href="https://www.colinodell.com">Colin O'Dell</a> &amp; <a href="//thephpleague.com">The League of Extraordinary Packages</a>.</span>
    <span>Site design by <a href="//reinink.ca">Jonathan Reinink</a> and <a href="//nyamsprod.com">Ignace Nyamagana Butera</a>.</span>
</footer>
<script src="/custom.js?"></script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
<script> docsearch({
    apiKey: 'f8a60b0120292f75f23d313f6cebba05',
    appId: '5WPQI5503X',
    indexName: 'commonmark-thephpleague',
    inputSelector: '#doc-search',
    algoliaOptions: { 'facetFilters': ["version:v2.x"] },
    debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
